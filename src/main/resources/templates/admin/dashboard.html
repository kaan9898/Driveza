<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Driveza | Admin Dashboard</title>
    <link rel="stylesheet" th:href="@{/css/driveza-app.css}">
</head>

<body class="adminBg">

<!-- Background Overlay -->
<div class="adminOverlay"></div>

<!-- Main Content Wrapper -->
<div class="adminContent">

    <header class="topbar topbar--enter">
        <div class="topbar__left">
            <a class="brand" th:href="@{/admin/dashboard}">
                <img class="brand__logo" th:src="@{/images/logo.svg}" alt="Driveza"/>
                <span class="brand__name">Driveza Admin</span>
            </a>
        </div>

        <nav class="topbar__nav">
            <a class="nav__link nav__link--active" th:href="@{/admin/dashboard}">Dashboard</a>
            <a class="nav__link" th:href="@{/admin/vehicles}">Vehicles</a>
        </nav>

        <div class="topbar__right">
            <form th:action="@{/logout}" method="post">
                <button class="btn btn--ghost" type="submit">Logout</button>
            </form>
        </div>
    </header>

    <main class="container">

        <!-- Page Header -->
        <section class="pageHead pageHead--enter">
            <div>
                <h1 class="pageTitle">Admin Dashboard</h1>
                <p class="pageSub">Live statistics from PostgreSQL database</p>
            </div>
        </section>

        <!-- Dashboard Stats Grid -->
        <section class="grid adminStatsGrid">

            <!-- Available / Total Vehicles -->
            <div class="card pad statCard">
                <div class="muted">Available Vehicles</div>

                <div class="statNumber">
                    <span class="count"
                          th:attr="data-value=${availableVehicles}">0</span>
                    <span class="muted">/</span>
                    <span class="count"
                          th:attr="data-value=${totalVehicles}">0</span>
                </div>

                <div class="statHint">Available out of total fleet</div>
            </div>

            <!-- Rented / Total Vehicles -->
            <div class="card pad statCard">
                <div class="muted">Rented Vehicles</div>

                <div class="statNumber">
                    <span class="count"
                          th:attr="data-value=${rentedVehicles}">0</span>
                    <span class="muted">/</span>
                    <span class="count"
                          th:attr="data-value=${totalVehicles}">0</span>
                </div>

                <div class="statHint">Rented out of total fleet</div>
            </div>

            <!-- Normal Users / Total Users -->
            <div class="card pad statCard">
                <div class="muted">Normal Users</div>

                <div class="statNumber">
                    <span class="count"
                          th:attr="data-value=${normalUsers}">0</span>
                    <span class="muted">/</span>
                    <span class="count"
                          th:attr="data-value=${totalUsers}">0</span>
                </div>

                <div class="statHint">Customers out of total users</div>
            </div>

            <!-- Admin Users / Total Users -->
            <div class="card pad statCard">
                <div class="muted">Admins</div>

                <div class="statNumber">
                    <span class="count"
                          th:attr="data-value=${adminUsers}">0</span>
                    <span class="muted">/</span>
                    <span class="count"
                          th:attr="data-value=${totalUsers}">0</span>
                </div>

                <div class="statHint">Admins out of total users</div>
            </div>

        </section>

    </main>

</div>

<!-- Count-Up Animation Script -->
<script>
    document.addEventListener("DOMContentLoaded", () => {
        const nums = document.querySelectorAll(".count");

        nums.forEach(el => {
            const target = Number(el.getAttribute("data-value")) || 0;
            const duration = 800;
            const start = performance.now();

            function tick(now) {
                const progress = Math.min((now - start) / duration, 1);
                const eased = 1 - Math.pow(1 - progress, 3); // easeOutCubic
                const value = Math.round(eased * target);
                el.textContent = value;

                if (progress < 1) requestAnimationFrame(tick);
            }

            requestAnimationFrame(tick);
        });
    });
</script>

</body>
</html>