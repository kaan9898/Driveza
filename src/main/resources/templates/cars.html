<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Driveza | Cars</title>

    <link rel="stylesheet" th:href="@{/css/driveza-app.css}" />
</head>

<body>

<!-- Top Bar -->
<header class="topbar">
    <div class="topbar__left">
        <a class="brand" th:href="@{/cars}">
            <img class="brand__logo" th:src="@{/images/logo.svg}" alt="Driveza" />
            <span class="brand__name">Driveza</span>
        </a>
    </div>

    <nav class="topbar__nav">
        <a class="nav__link nav__link--active" th:href="@{/cars}">Cars</a>
        <a class="nav__link" th:href="@{/map}">Map</a>
        <a class="nav__link" th:href="@{/account}">Account</a>
    </nav>

<!--    <div class="topbar__right">-->
<!--        <a class="btn btn&#45;&#45;ghost" th:href="@{/logout}">Logout</a>-->
<!--    </div>-->
    <form th:action = "@{/logout}" method="post" style="display:inline;">
        <button class="btn btn--ghost" type="submit">Logout</button>
    </form>

</header>

<main class="container">

    <!-- Page header -->
    <section class="pageHead">
        <div>
            <h1 class="pageTitle">Available Cars</h1>
            <p class="pageSub">Only <b>AVAILABLE</b> cars are shown for users.</p>
        </div>

        <!-- active rental quick action (optional UI) -->
        <div class="activeRental">
            <div class="activeRental__label">My Rental</div>
            <div class="activeRental__value">No active rental</div>
            <button class="btn btn--small btn--disabled" type="button" disabled>Return</button>
        </div>
    </section>

    <!-- Alerts -->
    <div class="alert alert--error" th:if="${param.error}">
        Something went wrong. Please try again.
    </div>
    <div class="alert alert--info" th:if="${param.success}">
        Action completed successfully.
    </div>

    <!-- Filters -->
    <section class="filters card">
        <form class="filters__grid" method="get" th:action="@{/cars}">
            <div class="field">
                <label class="label">Search model</label>
                <input class="input" name="q" type="text" placeholder="e.g., Prius, BMW X3" />
                <input type="hidden" name="lat" id="lat" />
                <input type="hidden" name="lon" id="lon" />
            </div>

            <div class="field">
                <label class="label">Sort</label>

                <select class="select" name="sort">
                    <option value="" th:selected="${param.sort == null}">Recommended</option>
                    <option value="distanceAsc" th:selected="${param.sort == 'distanceAsc'}">Distance (nearest)</option>
                    <option value="priceAsc" th:selected="${param.sort == 'priceAsc'}">Price (lowest)</option>
                </select>
            </div>

            <div class="field">
                <label class="label">Radius</label>
                <select class="select" name="radius">
                    <option value="1">1 km</option>
                    <option value="3" selected>3 km</option>
                    <option value="5">5 km</option>
                    <option value="10">10 km</option>
                </select>
            </div>

            <div class="filters__actions">
                <button class="btn" type="submit">Apply</button>
                <a class="btn btn--ghost" th:href="@{/cars}">Reset</a>
            </div>
        </form>

        <script>
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition((pos) => {
                    document.getElementById("lat").value = pos.coords.latitude;
                    document.getElementById("lon").value = pos.coords.longitude;
                });
            }
        </script>
    </section>

    <!-- Cars Grid -->
    <section class="grid">

        <!-- Show message if empty -->
        <div class="alert alert--info" th:if="${#lists.isEmpty(cars)}">
            No available cars right now.
        </div>

        <!-- Dynamic cards -->
        <article class="carCard" th:each="car : ${cars}">
            <img class="carCard__img" th:src="@{/images/car-placeholder.jpg}" alt="car"/>

            <div class="carCard__body">
                <div class="carCard__top">
                    <div>
                        <div class="carCard__title"
                             th:text="${car.model.brand + ' ' + car.model.model}">
                            Toyota Prius
                        </div>
                        <div class="carCard__meta" th:text="${car.type}"></div>
                    </div>

                    <span class="badge badge--ok" th:text="${car.status}"></span>
                </div>

                <div class="carCard__info">
                    <div class="infoRow">
                        <span class="muted">Price</span>
                        <b th:text="'€' + ${car.pricePerMin} + '/min'"></b>
                    </div>
                    <div class="infoRow">
                        <span class="muted">Lat</span>
                        <b th:text="${car.latitude}">56.9496</b>
                    </div>
                    <div class="infoRow">
                        <span class="muted">Lon</span>
                        <b th:text="${car.longitude}">24.1052</b>
                    </div>
                </div>

                <button class="btn" type="button">Rent</button>
            </div>
        </article>



        <!-- ✅ Option B: static demo cards (works now even without backend) -->
<!--        <article class="carCard">-->
<!--            <img class="carCard__img" th:src="@{/images/car-placeholder.jpg}" alt="car" />-->
<!--            <div class="carCard__body">-->
<!--                <div class="carCard__top">-->
<!--                    <div>-->
<!--                        <div class="carCard__title">Toyota Prius</div>-->
<!--                        <div class="carCard__meta">Hybrid • Automatic</div>-->
<!--                    </div>-->
<!--                    <span class="badge badge&#45;&#45;ok">AVAILABLE</span>-->
<!--                </div>-->

<!--                <div class="carCard__info">-->
<!--                    <div class="infoRow">-->
<!--                        <span class="muted">Distance</span><b>1.2 km</b>-->
<!--                    </div>-->
<!--                    <div class="infoRow">-->
<!--                        <span class="muted">Price</span><b>€10/h</b>-->
<!--                    </div>-->
<!--                </div>-->

<!--                <button class="btn" type="button">Rent</button>-->
<!--            </div>-->
<!--        </article>-->

<!--        <article class="carCard">-->
<!--            <img class="carCard__img" th:src="@{/images/car-placeholder.jpg}" alt="car" />-->
<!--            <div class="carCard__body">-->
<!--                <div class="carCard__top">-->
<!--                    <div>-->
<!--                        <div class="carCard__title">BMW X3</div>-->
<!--                        <div class="carCard__meta">SUV • Petrol</div>-->
<!--                    </div>-->
<!--                    <span class="badge badge&#45;&#45;ok">AVAILABLE</span>-->
<!--                </div>-->

<!--                <div class="carCard__info">-->
<!--                    <div class="infoRow">-->
<!--                        <span class="muted">Distance</span><b>2.8 km</b>-->
<!--                    </div>-->
<!--                    <div class="infoRow">-->
<!--                        <span class="muted">Price</span><b>€18/h</b>-->
<!--                    </div>-->
<!--                </div>-->

<!--                <button class="btn" type="button">Rent</button>-->
<!--            </div>-->
<!--        </article>-->

<!--        <article class="carCard">-->
<!--            <img class="carCard__img" th:src="@{/images/car-placeholder.jpg}" alt="car" />-->
<!--            <div class="carCard__body">-->
<!--                <div class="carCard__top">-->
<!--                    <div>-->
<!--                        <div class="carCard__title">Audi A4</div>-->
<!--                        <div class="carCard__meta">Sedan • Diesel</div>-->
<!--                    </div>-->
<!--                    <span class="badge badge&#45;&#45;ok">AVAILABLE</span>-->
<!--                </div>-->

<!--                <div class="carCard__info">-->
<!--                    <div class="infoRow">-->
<!--                        <span class="muted">Distance</span><b>4.0 km</b>-->
<!--                    </div>-->
<!--                    <div class="infoRow">-->
<!--                        <span class="muted">Price</span><b>€15/h</b>-->
<!--                    </div>-->
<!--                </div>-->

<!--                <button class="btn" type="button">Rent</button>-->
<!--            </div>-->
<!--        </article>-->

<!--    </section>-->

<!--    &lt;!&ndash; Pagination (UI only for now) &ndash;&gt;-->
<!--    <section class="pagination">-->
<!--        <button class="btn btn&#45;&#45;ghost btn&#45;&#45;small" type="button" disabled>Prev</button>-->
<!--        <div class="pagination__text">Page 1 of 5</div>-->
<!--        <button class="btn btn&#45;&#45;ghost btn&#45;&#45;small" type="button">Next</button>-->
   </section>

</main>

</body>
</html>